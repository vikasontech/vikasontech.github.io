<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Vikas Verma">
    <meta name="description" content="Vikas&#39;s personal website">
    <meta name="keywords" content="Blogger, Developer, Scurm Master">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Secure spring boot application with keycloak"/>
<meta name="twitter:description" content="Configure keycloak for spring application"/>

    <meta property="og:title" content="Secure spring boot application with keycloak" />
<meta property="og:description" content="Configure keycloak for spring application" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://vikasontech.github.io/posts/secure-spring-boot-application-with-keycloak/" />
<meta property="article:published_time" content="2018-11-30T12:32:26+07:00" />
<meta property="article:modified_time" content="2018-11-30T12:32:26+07:00" />


    
      <base href="https://vikasontech.github.io/posts/secure-spring-boot-application-with-keycloak/">
    
    <title>
  Secure spring boot application with keycloak · Vikas Blogs
</title>

    
      <link rel="canonical" href="https://vikasontech.github.io/posts/secure-spring-boot-application-with-keycloak/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css" integrity="sha384-Bfad6CLCknfcloXFOyFnlgtENryhrpZCe29RTifKEixXQZ38WheV+i/6YWSzkz3V" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="https://vikasontech.github.io/css/coder.min.a4f332213a21ce8eb521670c614470c58923aaaf385e2a73982c31dd7642decb.css" integrity="sha256-pPMyITohzo61IWcMYURwxYkjqq84XipzmCwx3XZC3ss=" crossorigin="anonymous" media="screen" />
    

    

    

    

    

    

    <link rel="icon" type="image/png" href="https://vikasontech.github.io/img/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://vikasontech.github.io/img/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.69.1" />
  </head>

  
  
  <body class="colorscheme-light">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="https://vikasontech.github.io/">
      Vikas Blogs
    </a>
    
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://vikasontech.github.io/posts/">Blogs</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://forms.gle/euaK9EqHRtizzzwx6">Contact Me</a>
          </li>
        
      
      
    </ul>
    
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">Secure spring boot application with keycloak</h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fas fa-calendar"></i>
              <time datetime='2018-11-30T12:32:26&#43;07:00'>
                November 30, 2018
              </time>
            </span>
            <span class="reading-time">
              <i class="fas fa-clock"></i>
              2-minute read
            </span>
          </div>
          <div class="categories">
  <i class="fas fa-folder"></i>
    <a href="https://vikasontech.github.io/categories/technical/">Technical</a></div>

          <div class="tags">
  <i class="fas fa-tag"></i>
    <a href="https://vikasontech.github.io/tags/keycloak/">keycloak</a>
      <span class="separator">•</span>
    <a href="https://vikasontech.github.io/tags/secrity/">secrity</a>
      <span class="separator">•</span>
    <a href="https://vikasontech.github.io/tags/spring-boot/">spring-boot</a></div>

        </div>
      </header>

      <div>
        
        <p>In last blog post of this series we saw how we can configure keycloak
for our application. Now in this tutorial we will see how we can use
keycloak with spring boot.</p>
<p><strong>Prerequisite</strong></p>
<ul>
<li>Docker</li>
<li>Keycloak</li>
</ul>
<p><strong>Version</strong></p>
<ul>
<li>Spring Boo: 1.5.17.RELEASE</li>
<li>Java: 1.8</li>
<li>Keycloak: 4.0.5-Final</li>
</ul>
<h1 id="create-sample-spring-boot-application"><strong>Create sample spring boot application</strong></h1>
<p><strong>Dependencies</strong></p>
<ul>
<li>Spring-boot-starter-web</li>
<li>Keycloak-spring-boot-starter</li>
</ul>
<p><strong>Create rest controller class</strong></p>
<script type="application/javascript" src="https://gist.github.com/vikasontech/70017889724bed1e3350b38a40d255ad.js"></script>

<p><strong>Secure App with keycloak</strong></p>
<p>Add maven dependency for keycloak and spring security -</p>
<ul>
<li>spring-boot-starter-security</li>
<li>keycloak-spring-boot-starter</li>
</ul>
<p>Configure keycloak server url and realms details in
application.properties file</p>
<script type="application/javascript" src="https://gist.github.com/vikasontech/4cd59c38757f8f6df9eff7bdf4ff16e4.js"></script>

<p><strong>Configure keycloak security settings in the application</strong></p>
<p>Add the blow class to configure the keycloak</p>
<script type="application/javascript" src="https://gist.github.com/vikasontech/82b136433b67a825a323e10b08c82694.js"></script>

<p>KeycloakSecurityConfigurer.class extends
KeycloakWebSecurityConfigurerAdapter.class that provide convenient base
class for creating a WebSecurityConfigurer instance secured by Keycloak.</p>
<p>GrantedAuthoritiesMapper is mapping interface which use to convert case
of the role used in the keycloak from lower case to uppercase.</p>
<p>KeycloakAuthenticationProvider perform authentication process.</p>
<p>NullAuthenticatedSessionStrategy since we are using rest full service so
we can provide null authenticated session strategy.</p>
<p>KeycloakConfigResolver use to tell keycloak to use spring boot
configuration. Instead use the configuration from the spring boot
configuration resolver.</p>
<p>keycloakAuthenticationProcessingFilterRegistrationBean,
keycloakPreAuthActionsFilterRegistrationBean are used avoid
re-registration of the filter.</p>
<h1 id="running-application"><strong>Running application</strong></h1>
<p>start the application using</p>
<p>mvn spring-boot:run</p>
<p>Call the admin api without security token
<img src="https://vikasontech.github.io/images/20181130/img1.png" alt="image"></p>
<p>Get access token for admin role
<img src="https://vikasontech.github.io/images/20181130/img2.png" alt="image"></p>
<p>Access admin api with access token
<img src="https://vikasontech.github.io/images/20181130/img3.png" alt="image"></p>
<p>Access user api with access token will give error because user role required for access user service.</p>
<p><img src="https://vikasontech.github.io/images/20181130/img4.png" alt="image"></p>
<p>Get access token for user role</p>
<p><img src="https://vikasontech.github.io/images/20181130/img5.png" alt="image"></p>
<p>Access user service</p>
<p><img src="https://vikasontech.github.io/images/20181130/img6.png" alt="image"></p>
<p>You can get the source code from <a href="http://bit.ly/2SkdMwL" target="_blank">Bitbucket</a></p>

      </div>


      <footer>
        


        
        
        
      </footer>
    </article>

    
  </section>

      </div>

      
  <footer class="footer">
    <section class="container">
      
        <p>#java #psm #scala #aws #springboot #keycloak</p>
      
      
        ©
        
        2020
         Vikas Verma 
      
      
      
    </section>
  </footer>

    </main>

    

    

  </body>

</html>
